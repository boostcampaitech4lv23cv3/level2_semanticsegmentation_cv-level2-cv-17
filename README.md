# ğŸŒ  Sixth Sense íŒ€ì˜ Semantic Segmentation í”„ë¡œì íŠ¸

ì“°ë ˆê¸°ê°€ ì°íŒ ì‚¬ì§„ì—ì„œ ì“°ë ˆê¸°ë¥¼ Segmentation í•˜ëŠ” ëª¨ë¸ì„ í†µí•œ ë¶„ë¦¬ìˆ˜ê±° ì¸ê³µì§€ëŠ¥ ë§Œë“¤ê¸° ëŒ€íšŒ

> ê¸°ê°„ : 2022.12.21 ~ 2023.01.05

![ë¶€ìŠ¤íŠ¸ ìº í”„ AI Tech 4ê¸°](https://img.shields.io/badge/%EB%B6%80%EC%8A%A4%ED%8A%B8%EC%BA%A0%ED%94%84%20AI%20Tech-4%EA%B8%B0-red)
![Level 2](https://img.shields.io/badge/Level-2-yellow)
![CV 17ì¡°](https://img.shields.io/badge/CV-17%EC%A1%B0-brightgreen)
![Semantic Segmentation ëŒ€íšŒ](https://img.shields.io/badge/%EB%8C%80%ED%9A%8C-Semantic%20Segmentation-blue)

![stages ai_competitions_227_overview_description](https://user-images.githubusercontent.com/9074297/208830640-df24aeaa-fc33-40ee-8756-1beca7a5f678.png)


## ğŸ˜ Members

<table>
    <thead>
        <tr>
            <th>ë°•ì„ ê·œ</th>
            <th>ë°•ì„¸ì¤€</th>
            <th>ì„œì¥ì›</th>
            <th>ì´ê´‘ë¯¼</th>
            <th>ì¥êµ­ë¹ˆ</th>
            <th>ì¡°íƒœí™˜</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td width="16%"><img src="https://user-images.githubusercontent.com/9074297/207550543-a4a35f97-c647-4013-b440-dbfec61b01d7.png" width="100%"/></td>
            <td width="16%"><img src="https://user-images.githubusercontent.com/9074297/207550381-3f2deddb-ffef-4249-8738-66d27c83ea79.png" width="100%"/></td>
            <td width="16%"><img src="https://user-images.githubusercontent.com/9074297/207550023-28ad4754-e60b-4a0c-835e-ea3c32108703.png" width="100%"/></td>
            <td width="16%"><img src="https://user-images.githubusercontent.com/9074297/207551768-ca68e744-70bf-452d-bd61-f4db912e59ee.png" width="100%"/></td>
            <td width="16%"><img src="https://user-images.githubusercontent.com/9074297/207583484-e4cff046-7656-4c27-90c9-0ce116418e70.png" width="100%"/></td>
            <td width="16%"><img src="https://user-images.githubusercontent.com/9074297/207550298-4dd75fe8-137d-4bad-accf-d56363c01895.png" width="100%"/></td>
        </tr>
        <tr>
            <td align="center"><a href="https://github.com/Sungyu-Park"><sub><sup>@Sungyu-Park</sup></sub></a></td>
            <td align="center"><a href="https://github.com/sjleo1"><sub><sup>@sjleo1</sup></sub></a></td>
            <td align="center"><a href="https://github.com/nanpuhaha"><sub><sup>@nanpuhaha</sup></sub></a></td>
            <td align="center"><a href="https://github.com/lkm6871"><sub><sup>@lkm6871</sup></sub></a></td>
            <td align="center"><a href="https://github.com/JKbin"><sub><sup>@JKbin</sup></sub></a></td>
            <td align="center"><a href="https://github.com/OMMANT"><sub><sup>@OMMANT</sup></sub></a></td>
        </tr>
    </tbody>
</table>

## ğŸ§‘â€ğŸ’» Contributions

- ë°•ì„ ê·œ :
- ë°•ì„¸ì¤€ :
- ì„œì¥ì› :
- ì´ê´‘ë¯¼ :
- ì¥êµ­ë¹ˆ :
- ì¡°íƒœí™˜ :

<br>

## :earth_asia: Project Overview

ë°”ì•¼íë¡œ ëŒ€ëŸ‰ ìƒì‚°, ëŒ€ëŸ‰ ì†Œë¹„ì˜ ì‹œëŒ€. ìš°ë¦¬ëŠ” ë§ì€ ë¬¼ê±´ì´ ëŒ€ëŸ‰ìœ¼ë¡œ ìƒì‚°ë˜ê³ , ì†Œë¹„ë˜ëŠ” ì‹œëŒ€ë¥¼ ì‚´ê³  ìˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ì´ëŸ¬í•œ ë¬¸í™”ëŠ” 'ì“°ë ˆê¸° ëŒ€ë€', 'ë§¤ë¦½ì§€ ë¶€ì¡±'ê³¼ ê°™ì€ ì—¬ëŸ¬ ì‚¬íšŒ ë¬¸ì œë¥¼ ë‚³ê³  ìˆìŠµë‹ˆë‹¤.

<img src="https://s3-ap-northeast-2.amazonaws.com/prod-aistages-public/app/Users/00000274/files/7645ad37-9853-4a85-b0a8-f0f151ef05be..png" height="200px"/>

ë¶„ë¦¬ìˆ˜ê±°ëŠ” ì´ëŸ¬í•œ í™˜ê²½ ë¶€ë‹´ì„ ì¤„ì¼ ìˆ˜ ìˆëŠ” ë°©ë²• ì¤‘ í•˜ë‚˜ì…ë‹ˆë‹¤. ì˜ ë¶„ë¦¬ë°°ì¶œ ëœ ì“°ë ˆê¸°ëŠ” ìì›ìœ¼ë¡œì„œ ê°€ì¹˜ë¥¼ ì¸ì •ë°›ì•„ ì¬í™œìš©ë˜ì§€ë§Œ, ì˜ëª» ë¶„ë¦¬ë°°ì¶œ ë˜ë©´ ê·¸ëŒ€ë¡œ íê¸°ë¬¼ë¡œ ë¶„ë¥˜ë˜ì–´ ë§¤ë¦½ ë˜ëŠ” ì†Œê°ë˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.

ë”°ë¼ì„œ ìš°ë¦¬ëŠ” ì‚¬ì§„ì—ì„œ ì“°ë ˆê¸°ë¥¼ Segmentationí•˜ëŠ” ëª¨ë¸ì„ ë§Œë“¤ì–´ ì´ëŸ¬í•œ ë¬¸ì œì ì„ í•´ê²°í•´ë³´ê³ ì í•©ë‹ˆë‹¤. ë¬¸ì œ í•´ê²°ì„ ìœ„í•œ ë°ì´í„°ì…‹ìœ¼ë¡œëŠ” ë°°ê²½, ì¼ë°˜ ì“°ë ˆê¸°, í”Œë¼ìŠ¤í‹±, ì¢…ì´, ìœ ë¦¬ ë“± 11 ì¢…ë¥˜ì˜ ì“°ë ˆê¸°ê°€ ì°íŒ ì‚¬ì§„ ë°ì´í„°ì…‹ì´ ì œê³µë©ë‹ˆë‹¤.

ì—¬ëŸ¬ë¶„ì— ì˜í•´ ë§Œë“¤ì–´ì§„ ìš°ìˆ˜í•œ ì„±ëŠ¥ì˜ ëª¨ë¸ì€ ì“°ë ˆê¸°ì¥ì— ì„¤ì¹˜ë˜ì–´ ì •í™•í•œ ë¶„ë¦¬ìˆ˜ê±°ë¥¼ ë•ê±°ë‚˜, ì–´ë¦°ì•„ì´ë“¤ì˜ ë¶„ë¦¬ìˆ˜ê±° êµìœ¡ ë“±ì— ì‚¬ìš©ë  ìˆ˜ ìˆì„ ê²ƒì…ë‹ˆë‹¤. ë¶€ë”” ì§€êµ¬ë¥¼ ìœ„ê¸°ë¡œë¶€í„° êµ¬í•´ì£¼ì„¸ìš”!

<br>

- Input : ì“°ë ˆê¸° ê°ì²´ê°€ ë‹´ê¸´ ì´ë¯¸ì§€ê°€ ëª¨ë¸ì˜ ì¸í’‹ìœ¼ë¡œ ì‚¬ìš©ë©ë‹ˆë‹¤. segmentation annotationì€ COCO formatìœ¼ë¡œ ì œê³µë©ë‹ˆë‹¤.
- Output : ëª¨ë¸ì€ pixel ì¢Œí‘œì— ë”°ë¼ ì¹´í…Œê³ ë¦¬ ê°’ì„ ë¦¬í„´í•©ë‹ˆë‹¤. ì´ë¥¼ submission ì–‘ì‹ì— ë§ê²Œ csv íŒŒì¼ì„ ë§Œë“¤ì–´ ì œì¶œí•©ë‹ˆë‹¤.

<br>

## ğŸš¨ Competition Rules

ë³¸ ëŒ€íšŒëŠ” ë°ì´í„°ë¥¼ êµ¬ì„±í•˜ê³  í™œìš©í•˜ëŠ” ë°©ë²•ì— ì§‘ì¤‘í•˜ëŠ” ê²ƒì„ ì¥ë ¤í•˜ëŠ” ì·¨ì§€ì—ì„œ, ì œê³µë˜ëŠ” ë² ì´ìŠ¤ ì½”ë“œ ì¤‘ ëª¨ë¸ê³¼ ê´€ë ¨í•œ ë¶€ë¶„ì„ ë³€ê²½í•˜ëŠ” ê²ƒì´ ê¸ˆì§€ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ì´ì— ëŒ€í•œ ì„¸ë¶€ì ì¸ ê·œì¹™ì€ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.

- ë² ì´ìŠ¤ë¼ì¸ ëª¨ë¸ì¸ EAST ëª¨ë¸ì´ ì •ì˜ë˜ì–´ ìˆëŠ” ì•„ë˜ íŒŒì¼ë“¤ì€ ë³€ê²½ì‚¬í•­ ì—†ì´ ê·¸ëŒ€ë¡œ ì´ìš©í•´ì•¼ í•©ë‹ˆë‹¤.
  - model.py
  - loss.py
  - east_dataset.py
  - detect.py
- ë³€ê²½ì´ ê¸ˆì§€ëœ íŒŒì¼ë“¤ì˜ ë‚´ìš©ì„ ì´ìš©í•˜ì§€ ì•Šê³  ëª¨ë¸ ê´€ë ¨ ë‚´ìš©ì„ ìƒˆë¡œ ì‘ì„±í•´ì„œ ì´ìš©í•˜ëŠ” ê²ƒë„ ëŒ€íšŒ ê·œì •ì— ì–´ê¸‹ë‚˜ëŠ” í–‰ìœ„ì…ë‹ˆë‹¤.
- ì´ì™¸ì˜ ë‹¤ë¥¸ íŒŒì¼ì„ ë³€ê²½í•˜ê±°ë‚˜ ìƒˆë¡œìš´ íŒŒì¼ì„ ì‘ì„±í•˜ëŠ” ê²ƒì€ ììœ ë¡­ê²Œ ì§„í–‰í•˜ì…”ë„ ë©ë‹ˆë‹¤.
  - [ì˜ˆì‹œ] dataset.pyì—ì„œ pre-processing, data augmentation ë¶€ë¶„ì„ ë³€ê²½
  - [ì˜ˆì‹œ] train.pyì—ì„œ learning rate scheduling ë¶€ë¶„ì„ ë³€ê²½

<br>

## ğŸ’¾ Dataset

### ê¸°ë³¸ ì œê³µëœ ë°ì´í„°ì…‹

-

### ì¶”ê°€ë¡œ í™œìš©í•œ ì™¸ë¶€ ë°ì´í„°ì…‹

-

<br>

## ğŸ’» Develop Environment

- OS : Ubuntu 18.04.5 LTS (bionic)
- CPU : Intel(R) Xeon(R) Gold 5120 CPU @ 2.20GHz (8 Cores, 8 Threads)
- RAM : 90GB
- GPU : Tesla V100-PCIE-32GB (NVIDIA : 450.80.02)
- Storage : 100GB
- Python : 3.8.5 (conda)
- CUDA : 11.0.221
- PyTorch : 1.7.1
- Segmentation Models PyTorch : 0.3.1
- MMSegmentation : 0.29.1, 1.0.0rc2

<br>

## ğŸ“‚ Project Structure

<details>
<summary>í”„ë¡œì íŠ¸ êµ¬ì¡° ì‚´í´ë³´ê¸°</summary>

```bash
.
â”œâ”€â”€ğŸ”—code -> ğŸ“/opt/ml/level2_dataannotation_cv-level2-cv-17/src
â”œâ”€â”€ğŸ“input
â”‚   â””â”€â”€ğŸ“data
â”‚       â”œâ”€â”€ğŸ“ICDAR17_Korean
â”‚       â”‚   â”œâ”€â”€ğŸ–¼ï¸img_1001.jpg
â”‚       â”‚   â””â”€â”€ğŸ–¼ï¸...
â”‚       â”œâ”€â”€ğŸ“„ICDAR17_Korean_UFO.json
â”‚       â”œâ”€â”€ğŸ“„ICDAR17_Korean_UFO_train.json
â”‚       â”œâ”€â”€ğŸ“„ICDAR17_Korean_UFO_valid.json
â”‚       â”œâ”€â”€ğŸ“campers
â”‚       â”‚   â”œâ”€â”€ğŸ–¼ï¸01.jpg
â”‚       â”‚   â””â”€â”€ğŸ–¼ï¸...
â”‚       â”œâ”€â”€ğŸ“„campers_UFO.json
â”‚       â”œâ”€â”€ğŸ“„campers_UFO_train.json
â”‚       â”œâ”€â”€ğŸ“„campers_UFO_valid.json
â”‚       â”œâ”€â”€ğŸ“cocotext
â”‚       â”‚   â””â”€â”€ train2014
â”‚       â”‚       â”œâ”€â”€ğŸ–¼ï¸COCO_train2014_000000187823.jpg
â”‚       â”‚       â””â”€â”€ğŸ–¼ï¸...
â”‚       â”œâ”€â”€ğŸ“hiertext
â”‚       â”‚   â”œâ”€â”€ğŸ“train
â”‚       â”‚   â”‚   â”œâ”€â”€ğŸ–¼ï¸dad729bb808f6b05.jpg
â”‚       â”‚   â”‚   â””â”€â”€ğŸ–¼ï¸...
â”‚       â”‚   â””â”€â”€ğŸ“validation
â”‚       â”‚       â”œâ”€â”€ğŸ–¼ï¸cc7423ec2a7adb30.jpg
â”‚       â”‚       â””â”€â”€ğŸ–¼ï¸...
â”‚       â”œâ”€â”€ğŸ“icdar13
â”‚       â”‚   â”œâ”€â”€ğŸ–¼ï¸100.jpg
â”‚       â”‚   â””â”€â”€ğŸ–¼ï¸...
â”‚       â”œâ”€â”€ğŸ“icdar15
â”‚       â”‚   â”œâ”€â”€ğŸ–¼ï¸img_966.jpg
â”‚       â”‚   â””â”€â”€ğŸ–¼ï¸...
â”‚       â”œâ”€â”€ğŸ“mlt19
â”‚       â”‚   â”œâ”€â”€ğŸ–¼ï¸tr_img_03540.jpg
â”‚       â”‚   â””â”€â”€ğŸ–¼ï¸...
â”‚       â”œâ”€â”€ğŸ“textocr
â”‚       â”‚   â””â”€â”€ğŸ“train_images
â”‚       â”‚       â”œâ”€â”€ğŸ–¼ï¸2413a55b0323deb0.jpg
â”‚       â”‚       â””â”€â”€ğŸ–¼ï¸...
â”‚       â”œâ”€â”€ğŸ“„OOV_UFO_train.json
â”‚       â”œâ”€â”€ğŸ“„OOV_UFO_valid.json
â”‚       â”œâ”€â”€ğŸ“„ICDAR17Korean_Campers_OOV_train.json
â”‚       â”œâ”€â”€ğŸ“„ICDAR17Korean_Campers_OOV_valid.json
â”‚       â”œâ”€â”€ğŸ”—train.json -> ğŸ“„ICDAR17Korean_Campers_OOV_train.json
â”‚       â””â”€â”€ğŸ”—valid.json -> ğŸ“„ICDAR17Korean_Campers_OOV_valid.json
â”œâ”€â”€ğŸ“level2_dataannotation_cv-level2-cv-17
â”‚   â””â”€â”€ğŸ“src
â”‚       â”œâ”€â”€ğŸ“trained_models
â”‚       â”‚   â””â”€â”€ğŸ“„latest.pth
â”‚       â”œâ”€â”€ğŸ“„convert_mlt.py
â”‚       â”œâ”€â”€ğŸ“„dataset.py
â”‚       â”œâ”€â”€ğŸ“„detect.py ---------- ë³€ê²½ ê¸ˆì§€ âš ï¸
â”‚       â”œâ”€â”€ğŸ“„deteval.py
â”‚       â”œâ”€â”€ğŸ“„east_dataset.py ---- ë³€ê²½ ê¸ˆì§€ âš ï¸
â”‚       â”œâ”€â”€ğŸ“„inference.py
â”‚       â”œâ”€â”€ğŸ“„loss.py ------------ ë³€ê²½ ê¸ˆì§€ âš ï¸
â”‚       â”œâ”€â”€ğŸ“„model.py ----------- ë³€ê²½ ê¸ˆì§€ âš ï¸
â”‚       â””â”€â”€ğŸ“„train.py
â””â”€â”€ğŸ“pths
    â””â”€â”€ğŸ“„vgg16_bn-6c64b313.pth
```

</details>

<br>

## ğŸ‘¨â€ğŸ« Evaluation Methods

Semantic Segmentationì—ì„œ ì‚¬ìš©ë˜ëŠ” ëŒ€í‘œì ì¸ ì„±ëŠ¥ ì¸¡ì • ë°©ë²•ì¸ mIoUë¡œ í‰ê°€í•©ë‹ˆë‹¤.

<details>
<summary>í‰ê°€ ë°©ë²• ìì„¸íˆ ì‚´í´ë³´ê¸°</summary>

### Test setì˜ mIoU (Mean Intersection over Union)ë¡œ í‰ê°€

- Semantic Segmentationì—ì„œ ì‚¬ìš©ë˜ëŠ” ëŒ€í‘œì ì¸ ì„±ëŠ¥ ì¸¡ì • ë°©ë²•
- IoU
  $$
  \mathrm{IoU}=\frac{|X \cap Y|}{|X \cup Y|}=\frac{|X \cap Y|}{|X|+|Y|-|X \cap Y|}
  $$

### Example of IoU

![image](https://user-images.githubusercontent.com/9074297/208380726-3bf69d83-4ec6-4e6b-bf94-994a51e5be75.png)

![image](https://user-images.githubusercontent.com/9074297/208380793-39cf224d-dcb3-4472-afd5-8c983b69e28a.png)

### [ì°¸ê³ ì‚¬í•­]

modelë¡œë¶€í„° ì˜ˆì¸¡ëœ maskì˜ sizeëŠ” 512 x 512 ì§€ë§Œ, ëŒ€íšŒì˜ ì›í™œí•œ ìš´ì˜ì„ ìœ„í•´ outputì„ ì¼ê´„ì ìœ¼ë¡œ 256 x 256 ìœ¼ë¡œ ë³€ê²½í•˜ì—¬ scoreë¥¼ ë°˜ì˜í•˜ê²Œ ë˜ì—ˆìŠµë‹ˆë‹¤.

### ì œì¶œ ë°©ë²•

1. ë² ì´ìŠ¤ë¼ì¸ ì½”ë“œ ì‹¤í–‰
2. submission.csv ì œì¶œ

</details>

<br>

## ğŸ‘€ How to Start

```bash
# clone repository
git clone https://github.com/boostcampaitech4lv23cv3/level2_semanticsegmentation_cv-level2-cv-17.git

# create symbolic link
ln -s level2_semanticsegmentation_cv-level2-cv-17/src code

# change directory
cd level2_semanticsegmentation_cv-level2-cv-17

# create conda environment
conda env create -f environment.yml

# activate conda environment
conda activate "segmentation"

# install mmcv-full using mim or pip
mim install mmcv-full==1.7.0
# pip install mmcv-full==1.7.0 -f https://download.openmmlab.com/mmcv/dist/cu110/torch1.7/index.html

# install mmsegmentation as editable mode
pip install -e mmsegmentation

# install pre-commit hook
pre-commit install

# train
python ./src/train.py

# inference
python ./src/inference.py
```
